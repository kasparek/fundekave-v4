<?xml version="1.0" encoding="utf-8"?>
<ns:CustoViewStack xmlns:mx="http://www.adobe.com/2006/mxml" 
	xmlns:ns="co.uk._4t2.disneyhannahoke.shell.view.components.*"
	creationPolicy="all" xmlns:local="*">
<mx:Script>
	<![CDATA[
		import mx.effects.Zoom;
		import mx.effects.Effect;
		import mx.validators.Validator;
		import co.uk._4t2.disneyhannahoke.shell.model.vo.GameVO;
		import co.uk._4t2.disneyhannahoke.shell.model.vo.TeamMemberVO;
		import co.uk._4t2.disneyhannahoke.shell.model.vo.TeamVO;
		import mx.controls.Alert;
		import assets.shell.SoundBank;
				
		
		public static const USER_ACTION:String = 'userAction';
		public static const MAIN_MENU:String = 'mainMenu';		
		public static const TITLE_PLAY:String = 'titlePlay';
		public static const TITLE_HIGHSCORES:String = 'titleHighscores';
		public static const HIGHSCORE_MORE:String = 'highscoreMore';
		public static const WELCOME_SKIP:String = 'welcomeSkip';
		public static const INPUT_SELECT_NEXT:String = 'inputSelectNext';
		public static const INPUT_PERMISSIONS_NEXT:String = 'inputPermissionNext';
		public static const TEAM_CREATE:String = 'teamCreate';
		public static const TEAM_CREATE_BACK:String = 'teamCreateBack';
		public static const TEAM_SELECT:String = 'teamSelect';
		public static const TEAM_CHANGE:String = 'teamChange';
		public static const CAPTAIN_SELECT:String = 'captainSelect';
		public static const CAPTAIN_CANCEL:String = 'captainCancel';
		public static const TEST_MODE:String = 'testModeScreen';
		public static const GAME_PRACTICE:String = 'gamePractice';
		public static const GAME_WELCOME_SKIP:String = 'gameWelcomeSkip';
		public static const GAME_SELECT:String = 'gameSelect';
		public static const GAME_INSTRUCTIONS:String = 'gameInstructions';
		public static const GAME_INSTRUCTIONS_BACK:String = 'gameInstructionsBack';
		public static const GAME_INSTRUCTIONS_MORE:String = 'gameInstructionsMore';
		public static const GAME_PLAY:String = 'gamePlay';
		public static const GAME_NEXT:String = 'gameNext';
		public static const GAME_JUDGEME:String = 'gameJudgeme';
		public static const GAME_FINAL_CHALLANGE:String = 'gameFinalChallange';
		public static const GAME_TEAM_SCORE:String = 'gameTeamScore';
		public static const INPUTS_PERMISSION_CHECK_SHOWN:String = 'inputsPermCheckShown';
		
		public static const TEAM_MEMBER_SAVE:String = 'teamMemberSave';
		
		public var userAction:String;
		
		//---lang
		[Bindable]
		public var lang:XML = new XML();
		
		[Bindable]
		public var teamsList:Array;
		
		[Bindable]
		private var _teamActive:TeamVO;
		[Bindable]
		public function get teamActive():TeamVO {
			return _teamActive;
		}
		public function set teamActive(value:TeamVO):void {
			_teamActive = value;
		} 
		
		[Bindable]
		private var _teamMemberActive:TeamMemberVO;
		[Bindable]
		public function get teamMemberActive():TeamMemberVO {
			return _teamMemberActive;
		}
		public function set teamMemberActive(value:TeamMemberVO):void {
			_teamMemberActive = value;
		} 
		
		[Bindable]
		public var availableGamesList:Array;
		
		[Bindable]
		public var gameVOActive:GameVO;
		
		[Bindable]
		public var playButtonEnabled:Boolean = false; //---when game is loaded enable, unloaded disable
		
		
		public function sendEvent( action:String ):void
		{
			userAction = action;
			dispatchEvent(new Event( USER_ACTION, true));
		} 
		
		public function teamSubmit():void {
			
			if( teamNameLbl.text.length > 0 ) {
				sendEvent( TEAM_CREATE );
			} else {
				teamNameLbl.setFocus()
			}
		}
		
		private function captainSelectTeamMember(next:Boolean):void {
			if(next==true) {
				//---select next
				teamMemberActive = teamActive.getTeamMemberNext();
			} else {
				//---select prev
				teamMemberActive = teamActive.getTeamMemberPrev();
			}
		}
	
	]]>
</mx:Script>

	<!--0 LOADING RESOURCES SCREEN -->
	<ns:CustomCanvas>
		
	</ns:CustomCanvas>

	<!--1 TITLE SCREEN -->
	<ns:TitleScreenCan id="titleCan" lang="{lang}" play="{sendEvent( TITLE_PLAY );}" highScores="{sendEvent( TITLE_HIGHSCORES );}" />
	
	<!--2 WELCOME VIDEO -->
	<ns:VideoView id="welcomeVideoCan" width="100%" height="100%" 
		skipVideo="{sendEvent( WELCOME_SKIP );}" 
		buttonText="{lang.Buttons.Item.(@name=='skip')}"
		lang="{lang}" />

	
	<!--3 INPUT SETUP -->
	<ns:InputSetupCan id="inputSetupCan" lang="{lang}" next="{sendEvent( INPUT_SELECT_NEXT );}" />
	
	
	<!--4 INPUT PERMISSIONS SETUP -->
	<ns:CustomCanvas id="inputPermissionCan" shown="{sendEvent( INPUTS_PERMISSION_CHECK_SHOWN );}">
		<mx:Canvas backgroundAlpha="0" width="500" height="354" x="-500">
			<mx:VBox horizontalAlign="center" horizontalCenter="0" y="36">
				<mx:Label styleName="h1" text="{lang.Headings.Item.(@name=='cammicAccess')}" />
				<mx:Text styleName="plainText" htmlText="{lang.Texts.Item.(@name=='inputPermissions1')}" />
				<ns:CustomHRule />	
			</mx:VBox>
			<mx:HBox verticalCenter="0" horizontalCenter="0">
				<ns:CustomButton click="{sendEvent( INPUT_PERMISSIONS_NEXT )}" label="{lang.Buttons.Item.(@name=='continue')}"
					clickSound="{SoundBank.Click_6}" rollOverSound="{SoundBank.Click_7}" />
			</mx:HBox>
			<mx:VBox horizontalAlign="center" horizontalCenter="0" y="273" textAlign="center">
				<ns:CustomHRule />
				<mx:Text selectable="false" styleName="boldText" textAlign="center" htmlText="{lang.Texts.Item.(@name=='inputPermissions2')}" />
			</mx:VBox>
		</mx:Canvas>
	</ns:CustomCanvas>
	
	<!--5 TEAM SETUP -->
	<ns:CustomCanvas backgroundAlpha="0" id="teamCreateCan">
		<mx:Canvas width="500" height="354" x="-500">
			<mx:VBox x="218" y="20">
				<mx:Label styleName="h2" text="{lang.Headings.Item.(@name=='createTeam')}" />
				<ns:CustomHRule />
			</mx:VBox>
			<mx:VBox x="218" y="76">
				<mx:Label styleName="strongText" text="{lang.Texts.Item.(@name=='enterTeamName')}" />
				<ns:CustomTextInput id="teamNameLbl" keyUp="{sendEvent( TEAM_CHANGE )}" maxChars="20" />
			</mx:VBox>
			<mx:VBox x="218" y="130">
				<mx:Label styleName="strongText" text="{lang.Texts.Item.(@name=='enterTeamSize')}" />
				<ns:CustomComboBox id="teamSizeCombo" dataProvider="{lang..Item.(@name=='teamSizeOptions').Item}"
					itemRollOverSound="{SoundBank.Crackle_noise}" mouseDownSound="{SoundBank.Click_7}" itemChangeSound="{SoundBank.Click_6}"/>
				<ns:CustomButtonLong click="{teamSubmit()}" label="{lang.Buttons.Item.(@name=='createTeam')}"
					rollOverSound="{SoundBank.Guitar_interface_07}" clickSound="{SoundBank.Guitar_interface_29}" />
			</mx:VBox>
			
			<mx:VBox x="218" y="245">
				<ns:CustomHRule />
				<mx:Label styleName="strongText" text="{lang.Texts.Item.(@name=='selectPrevTeam')}" />
				<ns:CustomComboBox id="teamPreviousCombo" dataProvider="{teamsList}" labelField="name"
					itemRollOverSound="{SoundBank.Crackle_noise}" 
					mouseDownSound="{SoundBank.Click_7}" 
					itemChangeSound="{SoundBank.Click_6}" />
				<ns:CustomButtonLong click="{sendEvent( TEAM_SELECT )}" 
					label="{lang..Item.(@name=='loadTeam')}"
					rollOverSound="{SoundBank.Guitar_interface_07}" 
					clickSound="{SoundBank.Guitar_interface_29}"/>
			</mx:VBox>
		</mx:Canvas>
	</ns:CustomCanvas>
	
	<!--6 TEAM MEMBERS SETUP -->
	<ns:TeamMemberSetup id="teamMemberCan" lang="{lang}" parentView="{this}" />
	
	<!--7 TEAM CAPTAIN CHANGE - just on existing team -->
	<ns:CustomCanvas id="teamCaptainCan">
		<mx:Canvas width="500" height="354" x="-500">
			<mx:VBox x="218" y="19">
				<mx:Label styleName="h2" text="{lang.Headings.Item.(@name=='reuseTeam')}" />
				<ns:CustomHRule />
			</mx:VBox>
			<mx:VBox x="218" y="76">
				<mx:Label styleName="strongText" text="{lang.Texts.Item.(@name=='teamSelectCaptain')}" />
				<ns:CustomComboBox id="captainCombo" 
					dataProvider="{teamActive.teamMembers}" 
					labelField="name"
					itemRollOverSound="{SoundBank.Crackle_noise}" 
					mouseDownSound="{SoundBank.Click_7}" 
					itemChangeSound="{SoundBank.Click_6}" />
				<ns:CustomButton click="{sendEvent( CAPTAIN_SELECT )}" label="{lang.Buttons.Item.(@name=='play')}"
					 rollOverSound="{SoundBank.Guitar_interface_07}" clickSound="{SoundBank.Guitar_interface_16}" />
			</mx:VBox>
			<mx:VBox x="218" y="194">
				<ns:CustomHRule />
				<mx:Label styleName="strongText" text="{lang.Texts.Item.(@name=='teamDontUse')}" />
				<ns:CustomButton click="{sendEvent( CAPTAIN_CANCEL )}" label="{lang.Buttons.Item.(@name=='back')}"
					rollOverSound="{SoundBank.Guitar_interface_07}" clickSound="{SoundBank.Guitar_interface_16}" /> 
			</mx:VBox>
		</mx:Canvas>
	</ns:CustomCanvas>
	
	<!--8 TEST MODE - SELECT a GAME to PRACTICE -->
	<ns:CustomCanvas id="testmodeCan">
	
		<mx:Canvas width="500" height="354" x="-500">
			
			<ns:HannahokeLogo right="0" top="0" />
			<mx:VBox x="218" y="120">
				<mx:Label styleName="h1" x="218" text="{lang.Headings.Item.(@name=='selectGameToPractice')}" />
				<mx:Text selectable="false" styleName="plainText" width="240" text="{lang.Texts.Item.(@name=='gamePracticeDesc')}" />
				<ns:CustomComboBox id="testgameCombo" labelField="name" 
					dataProvider="{availableGamesList}"
					itemRollOverSound="{SoundBank.Crackle_noise}" 
					mouseDownSound="{SoundBank.Click_7}" 
					itemChangeSound="{SoundBank.Click_6}" />
				<mx:Spacer height="3" />
				<ns:CustomHRule />
				<mx:Spacer height="3" />
				<ns:CustomButtonLong id="practiceButt" click="{sendEvent( GAME_PRACTICE )}" label="{lang.Buttons.Item.(@name=='gamePractice')}" 
					rollOverSound="{SoundBank.Guitar_interface_07}" clickSound="{SoundBank.Guitar_interface_29}"/>
				<ns:CustomButtonLong click="{sendEvent( TEAM_CREATE_BACK )}" label="{lang.Buttons.Item.(@name=='back')}"
					rollOverSound="{SoundBank.Guitar_interface_07}" clickSound="{SoundBank.Negative_01}" />
			</mx:VBox>
		</mx:Canvas>

	</ns:CustomCanvas>
		
	<!--9 SCORE -->
	<ns:HighscoreCan  id="highscoreCan" lang="{lang}" mainMenu="{sendEvent( MAIN_MENU )}" />
	
	<!-- 10 GAME WELCOME VIDEO -->
	<ns:VideoView id="welcomeGameVideoCan" width="100%" height="100%" 
		skipVideo="{sendEvent( GAME_WELCOME_SKIP );}" 
		buttonText="{lang.Buttons.Item.(@name=='skip')}"
		lang="{lang}" />
	
	<!-- 11 GAME SELECT -->
	<ns:CustomCanvas width="100%" height="100%">
		<mx:Canvas width="500" height="354" x="-500">
			<ns:HannahokeBigLogo id="hannahokeBigLogo" width="500" height="354" />
			<mx:VBox horizontalCenter="0" bottom="30" horizontalAlign="center" textAlign="center">
				<mx:Label styleName="h1" text="{lang.Headings.Item.(@name=='letStart')}" />
				<mx:Text styleName="plainText" selectable="false" htmlText="{lang.Texts.Item.(@name=='gameWelcome')}" />
				<ns:CustomHRule />
				<ns:CustomButton id="playButt" 
					enabled="false" 
					label="{lang.Buttons.Item.(@name=='play')}" 
					click="{sendEvent( GAME_SELECT )}"
					rollOverSound="{SoundBank.Guitar_interface_07}" 
					clickSound="{SoundBank.Guitar_interface_16}" />
			</mx:VBox>
		</mx:Canvas>
	</ns:CustomCanvas>
	
	<!-- 12 GAME PLAYER TURN -->
	<ns:CustomCanvas width="100%" height="100%">
		<mx:Canvas width="500" height="354" x="-500" horizontalScrollPolicy="off" verticalScrollPolicy="off">
			<ns:GameLogo x="218" y="20" width="291" height="106" gameType="{gameVOActive.type}" />

			<mx:VBox x="218" y="110" width="251" horizontalAlign="center" textAlign="center">
				<ns:CustomHRule />
				<mx:Text selectable="false" styleName="h5" width="100%" htmlText="{lang.Texts.Item.(@name=='playerTurn')}" />
				<mx:Label styleName="h3" text="{teamMemberActive.name}" />
				<mx:Text selectable="false" styleName="plainText" width="100%" htmlText="{lang.Texts.Item.(@name=='instructionsGameLoading')}" />
				<ns:CustomHRule />
			</mx:VBox>
		
			<mx:VBox bottom="20" x="218">
				<ns:CustomButtonLong click="{sendEvent( GAME_INSTRUCTIONS )}" label="{lang.Buttons.Item.(@name=='instructions')}" 
					rollOverSound="{SoundBank.Guitar_interface_08}" clickSound="{SoundBank.Guitar_interface_06}" />
				<ns:CustomButtonLong click="{sendEvent( GAME_PLAY )}" enabled="{playButtonEnabled}" label="{lang.Buttons.Item.(@name=='play')}"
					rollOverSound="{SoundBank.Guitar_interface_08}" clickSound="{SoundBank.Guitar_interface_18}" />
			</mx:VBox>
			
		</mx:Canvas>
	</ns:CustomCanvas>
	
	<!-- 13 GAME CAPTAIN SELECT -->
	<ns:CustomCanvas width="100%" height="100%">
		<mx:Canvas width="500" height="354" x="-500" horizontalScrollPolicy="off" verticalScrollPolicy="off">
			<ns:GameLogo x="218" y="20" width="291" height="106" gameType="{gameVOActive.type}" />
			
			<mx:VBox x="218" y="110" width="251" horizontalAlign="center" textAlign="center">
				<ns:CustomHRule />
				<mx:Label styleName="h3" text="{teamActive.captain.name}" />
				<mx:Text selectable="false" styleName="plainText" width="100%" htmlText="{lang.Texts.Item.(@name=='captainSelectPlayer')}" />
				<ns:CustomHRule />	
			</mx:VBox>
			
			<mx:HBox x="218" y="200" width="251" verticalAlign="middle" horizontalAlign="center" textAlign="center">
				<ns:ArrowButon  direction="left" click="{ captainSelectTeamMember(false) }" />
				<mx:Label styleName="h4" width="115" text="{teamMemberActive.name}" textAlign="center" />
				<ns:ArrowButon  direction="right" click="{ captainSelectTeamMember(true) }" />	
			</mx:HBox>
			
			<mx:VBox bottom="20" x="218">
				<ns:CustomButtonLong click="{sendEvent( GAME_INSTRUCTIONS )}" label="{lang.Buttons.Item.(@name=='instructions')}"
					rollOverSound="{SoundBank.Guitar_interface_08}" clickSound="{SoundBank.Guitar_interface_22}" />
				<ns:CustomButtonLong click="{sendEvent( GAME_PLAY )}" enabled="{playButtonEnabled}" label="{lang.Buttons.Item.(@name=='play')}"
					rollOverSound="{SoundBank.Guitar_interface_08}" clickSound="{SoundBank.Guitar_interface_21}" />
			</mx:VBox>
			
		</mx:Canvas>
	</ns:CustomCanvas>
	
	<!-- 14 GAME INSTRUCTIONS -->
	<ns:CustomCanvas width="100%" height="100%">
		<mx:Canvas width="500" height="354" x="-500" horizontalScrollPolicy="off" verticalScrollPolicy="off">
			<ns:GameLogo x="218" y="20" width="291" height="106" gameType="{gameVOActive.type}" />
			<mx:Label styleName="h3" left="20" top="40" text="{lang.Headings.Item.(@name=='instructions')}" />
			<mx:Label styleName="h6" left="20" top="64" text="{lang.Texts.Item.(@name=='howToPlay')}" />
			
			<ns:CustomHRule horizontalCenter="0" top="115" />
			
			<mx:Text left="20" right="20" width="460" top="125" selectable="false" id="instructionsProgressText" styleName="boldText" visible="false" />
			
			<mx:Text selectable="false" htmlText="{lang.Games.Instructions.Game.(@name==gameVOActive.type).Item.(@name=='shortText')}" styleName="instructionsShortText" left="20" right="20" width="460" top="{120 + ((instructionsProgressText.visible==true)?(30):(0))}" />
			<mx:Text selectable="false" htmlText="{lang.Games.Instructions.Game.(@name==gameVOActive.type).Item.(@name=='longText')}" styleName="instructionslongText" left="20" right="20" width="460" top="{150 + ((instructionsProgressText.visible==true)?(30):(0))}" />
			
			<ns:CustomHRule horizontalCenter="0" bottom="50" />
			
			<mx:HBox bottom="10" left="20">
				<ns:CustomButton click="{sendEvent( GAME_INSTRUCTIONS_BACK )}" label="{lang.Buttons.Item.(@name=='back')}" 
					rollOverSound="{SoundBank.Guitar_interface_08}" clickSound="{SoundBank.Guitar_interface_12}" />	
				<ns:CustomButton visible="false" click="{sendEvent( GAME_INSTRUCTIONS_MORE )}" label="{lang.Buttons.Item.(@name=='more')}"
					rollOverSound="{SoundBank.Guitar_interface_08}" clickSound="{SoundBank.Guitar_interface_13}"  />
			</mx:HBox>
			
			<ns:CustomButton right="20" bottom="10" click="{sendEvent( GAME_PLAY )}" enabled="{playButtonEnabled}" label="{lang.Buttons.Item.(@name=='play')}"
				 rollOverSound="{SoundBank.Guitar_interface_08}" clickSound="{SoundBank.Guitar_interface_23}" />
		</mx:Canvas>
	</ns:CustomCanvas>
	
	<!-- 15 GAME PLAY -->
	<ns:GameShellCan id="gameShellCan" />
	
	<!-- 16 GAME JUDGE -->
	<ns:JudgeCan id="judgeCan" parentView="{this}" />
	
	<!-- 17 PREFINAL SCREEN -->
	<ns:VideoView id="prefinalVideoCan" longButton="true" width="100%" height="100%" 
		skipVideo="{sendEvent( GAME_FINAL_CHALLANGE );}" 
		buttonText="{lang.Buttons.Item.(@name=='finalChallange')}"
		lang="{lang}" />
	
	<!-- 18 POSTFINAL SCREEN -->
	<ns:CustomCanvas width="100%" height="100%">
		<mx:Canvas width="500" height="354" x="0">
		
			<ns:VideoView id="postfinalVideoCan" width="100%" height="100%" 
				skipVideo="{sendEvent( GAME_TEAM_SCORE );}" 
				visible="false"
				longButton="true"
				lang="{lang}" />
		
			<mx:VBox verticalGap="5" verticalAlign="middle" 
				height="100" width="100%" backgroundColor="0x000000" 
				paddingTop="5" paddingBottom="5" backgroundAlpha="0.8" 
				horizontalCenter="0" bottom="0" 
				horizontalAlign="center">
				
				<!-- won seconds -->
				<mx:Text id="finalCongratText" selectable="false" styleName="h1" width="90%" textAlign="center"  />
				
				<ns:CustomButtonLong click="{postfinalVideoCan.skipVideoManual()}" 
					label="{lang.Buttons.Item.(@name=='teamScore')}" />
			</mx:VBox>
		
		</mx:Canvas>
	</ns:CustomCanvas>
	
</ns:CustoViewStack>
