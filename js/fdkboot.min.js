jQuery.base64=function(a){function b(a,b){var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(b));if(-1===c)throw"Cannot decode base64";return c}function c(a,b){var c=a.charCodeAt(b);if(255<c)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return c}return{decode:function(a){var c=0,e,g,h=a.length,k=[];a=String(a);if(0===h)return a;if(0!==h%4)throw"Cannot decode base64";"="===a.charAt(h-1)&&(c=1,"="===a.charAt(h-2)&&(c=2),h-=4);for(e=0;e<h;e+=4)g=b(a,e)<<18|b(a,
e+1)<<12|b(a,e+2)<<6|b(a,e+3),k.push(String.fromCharCode(g>>16,g>>8&255,g&255));switch(c){case 1:g=b(a,e)<<18|b(a,e+1)<<12|b(a,e+2)<<6;k.push(String.fromCharCode(g>>16,g>>8&255));break;case 2:g=b(a,e)<<18|b(a,e+1)<<12,k.push(String.fromCharCode(g>>16))}return k.join("")},encode:function(a){if(1!==arguments.length)throw"SyntaxError: exactly one argument required";a=String(a);var b,e,g=[],h=a.length-a.length%3;if(0===a.length)return a;for(b=0;b<h;b+=3)e=c(a,b)<<16|c(a,b+1)<<8|c(a,b+2),g.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>
18)),g.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>12&63)),g.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>6&63)),g.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e&63));switch(a.length-h){case 1:e=c(a,b)<<16;g.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>18)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>12&63)+"==");break;case 2:e=
c(a,b)<<16|c(a,b+1)<<8,g.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>18)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>12&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>6&63)+"=")}return g.join("")},VERSION:"1.0"}}(jQuery);
var Fajax=new function(){var a=this;a.xhrList={};a.top=0;a.formStop=!1;a.formSent=null;a.init=function(){0<$(".fajaxform").length&&listen("btn","click",Fajax.form);0<$(".fajaxpager").length&&listen("fajaxpager","click",a.pager);listen("fajaxa","click",a.a);$.ajaxSetup({scriptCharset:"utf-8",contentType:"text/xml; charset=utf-8",dataType:"xml",processData:!1,cache:!1})};a.pager=function(){return!1};a.a=function(b){b=$(b.currentTarget);var c=b.attr("href");a.top=null;if(b.hasClass("confirm")&&!confirm(b.attr("title")))return!1;
var d=gup("k",c),f=b.attr("id"),e=gup("m",c);d||(d=0);c=e+"/"+gup("d",c)+"/"+d;f&&(c+="/"+f);b.hasClass("keepScroll")&&(a.top=$(window).scrollTop());b.hasClass("progress")&&(b=$(".showProgress"),f=b.height(),b.addClass("lbLoading").css("height",(0<f?f:$(window).height())+"px"));a.action(c);return!1};a.action=function(b){b=b.split("/");var c=b[0],d=b[1],f=b[2],e=b[3],g=!1,h=!1;0==f&&(f=null);if(d)for(b=d.split(";");0<b.length;)d=b.shift().split("="),0==d[1].indexOf("$")&&(d[1]=gup(d[1].substr(1),window.location.search)),
a.add(d[0],d[1]),"result"==d[0]&&(g=!0),"resultProperty"==d[0]&&(h=!0);e&&(g||a.add("result",e),h||a.add("resultProperty","$html"));a.send(c,f);return!1};a.form=function(b,c){var d=b?b.currentTarget:null,f=d?$(d):null;tinymce&&tinymce.triggerSave();if(!(!b&&!c||b&&!$(d.form).hasClass("fajaxform")||f&&f.hasClass("noFajax"))){b&&b.preventDefault();if(1==a.formStop)return a.formStop=!1;if(f&&f.hasClass("confirm")&&!confirm(f.attr("title")))return!1;a.formSent=c?c:d.form;for(var f=$(a.formSent).serializeArray(),
e,g=!1,h=!1;0<f.length;){var k=f.shift();"m"==k.name?e=k.value:a.add(k.name,k.value);"result"==k.name&&(g=!0);"resultProperty"==k.name&&(h=!0)}g||a.add("result",$(a.formSent).attr("id"));h||a.add("resultProperty","$html");a.add("action",d?d.name:"save");a.add("k",gup("k",a.formSent.action));a.send(e?e:gup("m",a.formSent.action),gup("k",a.formSent.action));$(".btn").attr("disabled","disabled");return!1}};a.request=new function(){var b=this;b.a=[];b.s='<Item name="{KEY}"><![CDATA[{DATA}]]\x3e</Item>';
b.reset=function(){a.request.a=[]};b.add=function(a,d){b.a.push(b.s.replace("{KEY}",a).replace("{DATA}",d))};b.get=function(){var a="";0<b.a.length&&(a="<FXajax><Request>"+b.a.join("")+"</Request></FXajax>");b.a=[];return a}};a.add=function(b,c){a.request.add(b,c)};a.cancel=function(a){Fajax.xhrList[a].abort()};a.send=function(b,c,d){var f=a.request.get();0==c&&(c=null);c||(c=_fdk.cfg.page);-1==c&&(c="");for(var e=[],g=decodeURIComponent(window.location.search.replace("?","")).split("&");0<g.length;){var h=
g.pop(),k=h.substr(0,h.indexOf("="));"k"!=k&&"i"!=k&&"p"!=k&&"m"!=k&&"d"!=k&&e.push(h)}a.xhrList[b]=$.ajax({url:"?m="+b+"-x"+(c?"&k="+c:"")+(0<e.length?"&"+e.join("&"):""),type:0<f.length?"POST":"GET",data:f,error:function(a,b,c){console.log("Fajax::error "+b+" "+c);0!=a.readyState&&0!=a.status&&(d||msg("danger",_fdk.lng.ajax.error+" "+b+" "+c.substr(0,c.indexOf("<"))))},complete:function(c,e){a.xhrList[b]=null;a.formSent&&($(".btn").removeAttr("disabled"),a.formSent=null);"success"==e&&a.response.run(c.responseXML)}})};
a.response=new function(){this.run=function(a){$(a).find("Item").each(function(){var a=$(this),b=a.attr("target"),f=a.attr("property"),a=a.text();switch(b){case "document":window[b][f]=a;break;case "call":b=f.split(".");for(f=window;0<b.length;)f=f[b.shift()];f.apply(this,a.split(","));break;default:switch(f){case "void":break;default:if("$"==f[0])$("#"+b)[f.replace("$","")](a);else"value"==f?$("#"+b).val(a):$("#"+b).attr(f,a)}}})}}},isInit=!1,topBannerHeight=0,topBannerMargin=0;
function topBannerPosition(){if(!(0<topBannerHeight)){var a=$(".top-image").data("valign"),b=$(".top-image").height(),c=$(".top-image img").height(),d=0;"middle"==a?d=(b-c)/2:"bottom"==a&&(d=b-c);d+=$(".top-image").data("margin");d=0<d?0:d+c<b?b-c:d;$(".top-image img").stop().animate({"margin-top":d+"px"},100)}}function loadSidebarPanel(a){Fajax.add("panel",a.data("src"));Fajax.send("sidebar-get",_fdk.cfg.page)}
function boot(){Lazy.load([_fdk.cfg.jsUrl+"i18n/_fdk.lng."+(_fdk.cfg.lang?_fdk.cfg.lang:"cs")+".js"],boot);if(!isInit&&(isInit=!0,$("img").unveil(),$(".sidebar-content").each(function(){var a=$(this),c=parseInt($(this).data("delay"));0<c?setTimeout(function(){loadSidebarPanel(a)},c):loadSidebarPanel(this)}),"/"!=window.location.pathname&&(_fdk.fuup.fuga.service.url=window.location.pathname+_fdk.fuup.fuga.service.url),$("#head-banner").on("click",function(){var a=$("#head-banner img").height();0==
topBannerHeight?(topBannerHeight=$(".top-image").css("height"),topBannerMargin=$(".top-image img").css("marginTop"),$(".top-image").animate({height:a+"px"},500),$(".top-image img").animate({marginTop:"0px"},500),0<$(this).attr("href").length&&0==$("#topImageLink").length&&$(".top-image").append('<div id="topImageLink" class="alert alert-info" style="top:'+(parseInt(topBannerHeight.replace("px",""))-60)+'px;"><a href="'+$(this).attr("href")+'">'+$(this).attr("title")+"</a>")):($(".top-image").animate({height:topBannerHeight},
500),$(".top-image img").animate({marginTop:topBannerMargin},500),topBannerHeight=0);return!1}),setTimeout(function(){0<$("#galeryFeed").length&&Fajax.send("page-thumbs",_fdk.cfg.page)},1E3),0<$("#head-banner").length&&($(window).resize(topBannerPosition).resize(),$(".top-image img").on("load",topBannerPosition)),$('a[data-toggle="tab"]').on("shown.bs.tab",function(a){var c=$(a.target).attr("href"),d=$(a.target).data("target");d&&$(d).is(":empty")&&$.ajax({type:"GET",url:c.replace("show","show-x"),
complete:function(a){a.responseText&&$(d).html(a.responseText)}})}),gaLoad(),calendarInit(),0<$("#detailFoto").length&&ImgNext.init(),$(window).width(),0==$("#sidebar").length&&$("body").addClass("bodySidebarOff"),$(".expand").autogrow(),$(".opacity").bind("mouseenter",function(){$(this).fadeTo("fast",1)}).bind("mouseleave",function(){$(this).fadeTo("fast",.5)}),fajaxInit(),fconfirmInit(),switchOpen(),$(".thumbnail-xs a").each(function(){$(this).addClass("history")}),$(".mapThumbLink").bind("click",
gooMapiThumbClick),(0<$(".geoInput").length||0<$(".mapLarge").length)&&gooMapiInit(),History.Adapter.bind(window,"statechange",function(){var a=History.getState();History.log("statechange:",a.data,a.title,a.url);0<parseInt(a.data.i)&&(Fajax.xhrList["item-show"]&&(History.log("cancel ajax:","item-show"),Fajax.cancel("item-show")),$(".gallery").flickity("select",$("div[data-itemid='"+a.data.i+"']").index()),Fajax.action(a.data.action+"/i="+a.data.i+"/0/"+a.data.eid))}),listen("history","click",function(a){var c=
gup("i",a.currentTarget.href);History.pushState({action:"item-show",eid:$(a.target).attr("id"),i:c},"Loading ...","?i="+c);return!1}),slimboxInit(),Fullscreen.init(),fuupInit(),datePickerInit(),0<parseInt(_fdk.cfg.user))){ckedInit();$("#recipient").change(avatarfrominput);$("#selectAllCheckbox").change(function(){var a=$(this).is(":checked");$(":checkbox").each(function(){a?$(this).attr("checked","checked"):$(this).removeAttr("checked")})});$("#ppinput").hide();$("#saction").change(function(a){"setpp"==
$("#saction option:selected").attr("value")?$("#ppinput").show():$("#ppinput").hide()});$("#recipientList").change(function(a){var c=[];$("#recipientList option:selected").each(function(){c.push($(this).text())});c&&$("#recipient").val(c.join(",")).change();avatarfrominput()});GaleryEdit.init(_fdk.cfg,_fdk.lng.galery);0<parseInt(_fdk.cfg.msgTi)&&Msg.startPoll();var a=$("#accessSel");0<a.length&&a.change(function(){0==$(this).val()?$("#rule1").show():$("#rule1").hide()}).change()}}
function recaptchaStart(){Lazy.load(["http://www.google.com/recaptcha/api/js/recaptcha_ajax.js"],recaptchaStart)&&Recaptcha.create("6LexXNkSAAAAAE_BDWQHhapdx-XPHItdWgBvDTSm","recaptchaBox",{tabindex:3})}function jUIInit(){Lazy.load(_fdk.load.ui,jUIInit)&&(datePickerInit(),ckedInit(),fajaxInit(),fconfirmInit(),gooMapiInit(),fuupInit(),slimboxInit(),GaleryEdit.init(_fdk.cfg,_fdk.lng.galery),$(".expand").autogrow())}
function gooMapiInit(){Lazy.load(_fdk.load.goomapi,gooMapiInit)&&GooMapi.init(_fdk.cfg,_fdk.lng.goomapi)}var gooMapiThumbClickElement=null;function gooMapiThumbClick(){$(this).unbind("click",gooMapiThumbClick);gooMapiThumbClickElement||(gooMapiThumbClickElement=this);Lazy.load(_fdk.load.goomapi,gooMapiInit)&&($(gooMapiThumbClickElement).click(),gooMapiThumbClickElement=null)}
function ckedInit(){0!=$(".markitup").length&&Lazy.load(_fdk.load.richta,ckedInit)&&(tinymce.remove(),tinymce.init({selector:".markitup",menubar:!1,toolbar:"save | undo redo | styleselect | bold italic | link unlink image | alignleft aligncenter alignright alignjustify bullist blockquote | visualblocks code fullscreen",mode:"textareas",toolbar_items_size:"small",save_onsavecallback:function(a){a=$("#"+a.id)[0].form;console.log("TinyMCE Save");Fajax.form(null,a);return!1},plugins:["autoresize","autosave save",
"advlist autolink lists link image anchor","searchreplace visualblocks code fullscreen","media contextmenu paste"]}))}
function calendarInit(){if(0!=$("#calendar-inline").length&&Lazy.load(_fdk.load.ui,calendarInit)){var a=$("#calendar-inline").data("dateset"),b=$("#calendar-inline").data("minviewmode"),c=gup("date",window.location.href);c&&(4==c.length?c+="-01-01":7==c.length&&(c+="-01"),a=c);calendarDate=new Date(a);$("#calendar-inline").on("show",function(){$("th.datepicker-switch").on("click",calendarInlineInvalidate);$("th.next").on("click",calendarInlineInvalidate);$("th.prev").on("click",calendarInlineInvalidate);
calendarInlineInvalidate()}).datepicker({date:a,language:"cs",minViewMode:b?b:0,weekStart:1}).on("changeYear",calendarInlineInvalidate).on("changeDate",function(a){var b=calendarViewMode(),c=gup("c",window.location.href);a="?k="+_fdk.cfg.page+(c?"&c="+c:"")+"&date="+a.date.getFullYear()+(2>b?"-"+("0"+(a.date.getMonth()+1)).slice(-2):"")+(1>b?"-"+("0"+a.date.getDate()).slice(-2):"");window.location.replace(a)}).on("changeMonth",calendarInlineInvalidate);a&&(a=a.split("-"),a=new Date(parseInt(a[0]),
parseInt(a[1])-1,parseInt(a[2])),$("#calendar-inline").datepicker("update",a))}}function calendarViewMode(){var a=$("#calendar-inline")[0];return"block"==$(".datepicker-months",a).css("display")?1:"block"==$(".datepicker-years",a).css("display")?2:0}function calendarInlineInvalidate(a){a&&a.date&&(calendarDate=a.date);calendarIsInvalid||(calendarIsInvalid=!0,setTimeout(calendarInlineUpdate,10))}var calendarDate,calendarFirstInit=!0,calendarDataLoaded={},calendarIsInvalid=!1;
function calendarInlineUpdate(){var a,b;calendarIsInvalid=!1;var c=$("#calendar-inline"),d=calendarViewMode();if(!calendarFirstInit&&(2==d||calendarDate)){calendarDate&&(a=calendarDate.getFullYear(),b=parseInt(calendarDate.getMonth())+1);var f=d+"-"+(2>d?a+(1>d?"-"+b:""):"");calendarDataLoaded[f]?calendarLoading=null:(Fajax.add("loading",f),d&&Fajax.add("viewmode",d),1>d&&Fajax.add("month",b),2>d&&Fajax.add("year",a),Fajax.send("calendar-show",""))}calendarFirstInit=!1;a=$(".event",c[0]);$("td.day",
c[0]).each(function(){$(this).removeClass("active")});$("span.month",c[0]).each(function(){$(this).removeClass("active")});$("span.year",c[0]).each(function(){$(this).removeClass("active")});a.each(function(){$("span",this).remove();var a=String($(this).data("date")),b=$(this).html();if(2==d)$("span.year",c[0]).each(function(){$(this).removeClass("old");$(this).removeClass("new");$(this).html()==a&&($(this).addClass("active"),$(this).attr("title",b))});else if(1==d){var f=$(".datepicker-switch",c[0]).html().substr(-4);
if(0==a.indexOf(f)){var k=parseInt(a.substr(5)),q=1;$("span.month",c[0]).each(function(){q==k&&($(this).addClass("active"),$(this).attr("title",b));q++})}}else f=calendarDate?calendarDate:c.datepicker("getDate"),f=f.getFullYear()+"-"+("0"+(f.getMonth()+1)).slice(-2)+"-",0==a.indexOf(f)&&$("td.day",c[0]).each(function(){var c=parseInt($(this).html()),d=parseInt(a.substr(8));c!=d||$(this).hasClass("new")||$(this).hasClass("old")||($(this).addClass("active"),$(this).attr("title",b))})})}
function datePickerInit(){0!=$(".date").length&&Lazy.load(_fdk.load.ui,datePickerInit)&&$(".date").datepicker({todayBtn:!0,weekStart:1,autoclose:!0,language:"cs",calendarWeeks:!0,todayHighlight:!0,format:"dd.mm.yyyy"})}function calendarLoaded(a){calendarDataLoaded[a]=!0}function calendarUpdate(a){a=a.split("\n");for(var b in a){var c=$(a[b]).data("id");0==$("#calendar-inline div.event[data-id='"+c+"']").length&&$("#calendar-inline").append(a[b])}calendarInlineInvalidate()}
function slimboxInit(){0==$("a[rel^='lightbox']").length&&0==$(".fotomashup").length||!Lazy.load(_fdk.load.colorbox,slimboxInit)||($(".fotomashup a").colorbox({rel:"grp1",title:function(){return'<a href="'+$(this).attr("href")+'">Album '+$(this).attr("title")+"</a>"},href:function(){return $("img",this).data("image")},scalePhotos:!0,maxHeight:"100%",maxWidth:"100%"}),$("a[rel^='lightbox']").colorbox({scalePhotos:!0,maxHeight:"100%",maxWidth:"100%"}))}
function fuupInit(){0!=$(".fuup").length&&Lazy.load(_fdk.load.swf,fuupInit)&&$(".fuup").each(function(a){a=$(this).attr("id");var b=$.base64.encode(JSON.stringify(_fdk.fuup[a]));swfobject.embedSWF(_fdk.cfg.assUrl+"load.swf",a,"100","25","10.0.12",_fdk.cfg.assUrl+"expressInstall.swf",{file:_fdk.cfg.assUrl+"Fuup.swf",config:b,containerId:a},{menu:"false",scale:"noScale",allowFullscreen:"true",allowScriptAccess:"always",bgcolor:"",wmode:"transparent"})})}
function friendRequestInit(a){$("#friendrequest").remove();$("#sysmsgBox").after(a);$("#friendrequest").removeClass("hidden").show("slow");fajaxInit();$("#cancel-request").off("click").on("click",function(a){remove("friendrequest");return!1})}function fajaxInit(){Fajax.init()}function fconfirmInit(a){$(".confirm").each(function(){var a=!1;this.form&&(a=$(this.form).hasClass("fajaxform"));$(this).hasClass("fajaxa")||a||$(this).bind("click",onConfirm)})}
function onConfirm(a){confirm($(a.currentTarget).attr("title"))||(preventAjax=!0,a.preventDefault())}function shiftTo(a){a||(a=0);$(window).scrollTop(a)}function scrollToBottom(a){$("#"+a).animate({scrollTop:$("#"+a)[0].scrollHeight},1E3)}function enable(a){$("#"+a).removeAttr("disabled")}function remove(a){$("#"+a).remove()}function switchOpen(){$(".switchOpen").click(function(){$("#"+this.rel).toggleClass("hidden");return!1})}function listen(a,b,c){$("."+a).unbind(b,c).bind(b,c)}
function gup(a,b){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c=(new RegExp("[\\?&|]"+a+"=([^&#|]*)")).exec(b);return null===c?0:c[1]}var msgId=1;function msg(a,b){$("#sysmsgBox").append('<div id="sysmsg'+msgId+'" class="alert alert-'+a+' alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>'+b+"</div>");$("#sysmsg"+msgId).delay("10000").hide("slow");msgId++}function redirect(a){window.location.replace(a)}
function avatarfrominput(a){Fajax.add("username",$("#recipient").val());Fajax.add("call","fajaxInit");Fajax.send("post-avatarfrominput","")}function fuupUploadComplete(a,b){"error"==a&&alert(_fdk.lng.galery[b]);if("complete"==a){var c=$("#i").attr("value");0<c&&Fajax.add("i",c);Fajax.add("call","jUIInit");Fajax.send("item-image",_fdk.cfg.page)}}
function tempStoreDeleteInit(){$("#tempStoreButt").click(function(a){$("#imageHolder").html("");Fajax.send("item-tempStoreFlush",_fdk.cfg.page);a.preventDefault();return!1})}
var Msg=new function(){var a=this;a.getData=function(){var a=gup("p",window.location.href),c=[],d=[];$(".fitem.unread.sent").each(function(){c.push($(this).attr("id").replace("mess",""))});$(".msg-xs").each(function(){d.push($(this).attr("id").replace("messxs",""))});0<c.length&&Fajax.add("unreadedSent",c.join(","));0<d.length&&Fajax.add("xsShow",d.join(","));"fpost"==_fdk.cfg.page&&0<a&&Fajax.add("p",a);return Fajax.request.get()};a.startPoll=function(){$.PeriodicalUpdater("?m=post-poll-x&k="+_fdk.cfg.page,
{data:a.getData,minTimeout:_fdk.cfg.msgTi/2,maxTimeout:_fdk.cfg.msgTi,multiplier:2},function(a,c,d,f){Fajax.response.run(a)})};a.chatInit=function(){$(".msg-text").off("keypress").on("keypress",function(a){13==a.which&&($("#msgBtnSubmit").click(),a.preventDefault(),$("#msgList").append('<div class="msg-xs" id="messxs0">'+$("#msgText").val()+"</div>"),$("#msgText").val(""),scrollToBottom("msgList"))})}};
(function(a){a.fn.autogrow=function(b){this.filter("textarea").each(function(){var b=a(this);b.height();var d=function(){var a=parseInt(b.css("padding-top").replace("px","")),e=parseInt(b.css("padding-bottom").replace("px","")),d=parseInt(b.css("line-height").replace("px","")),h=b.height(),a=b.prop("scrollHeight")-(a+e);a>h&&b.css("height",a+2*d)};b.off("change",d).on("keydown",d).change(d).keydown(d).change()});return this}})(jQuery);
function indexOf(a,b,c){for(c=c||0;c<a.length;c++)if(a[c]==b)return c;return-1}function gaLoad(){var a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}
(function(a){a.fn.pop=function(){var a=this.get(-1);this.splice(this.length-1,1);return a};a.fn.shift=function(){var a=this.get(0);this.splice(0,1);return a}})(jQuery);
var Resize=new function(){var a=this;a.t=0;a.cw=0;a.ch=0;a.flktySelected=null;a.flktyTimeout=0;a.queue=null;a.lazyLoad=function(b){$img=$(b);$(b).data("lazy")?($(b).attr("src",$(b).data("lazy")),$(b).data("lazy",null)):a.nextQueue()};a.isQueue=!1;a.doQueue=function(){a.queue=$("img.gallery-cell-image");a.queue.shift();a.lazyLoad(a.queue.pop());0<a.queue.length&&(a.isQueue=!0)};a.nextQueue=function(){a.isQueue&&(0===a.queue.length?a.isQueue=!1:a.lazyLoad(a.queue.shift()))};a.init=function(){$(window).resize(a.on).resize();
var b=$("img.gallery-cell-image:first")[0];if(b.complete)setTimeout(a.doQueue,500);else $(b).on("load",function(){setTimeout(a.doQueue,500)});$(".gallery img").load(function(){var b=$(window),d=b.width(),b=b.height();imgResizeToFit($(this),Fullscreen.isFullscreen?d:$("#fullscreenBox").width(),b-0,Fullscreen.isFullscreen);ImgNext.hud();a.isQueue&&0<a.queue.length&&a.nextQueue()}).error(function(){var a=(new Date).getTime(),a=$(this).attr("src")+"?"+a;$(this).attr("src",a);console.log("Error Loading Image "+
a)});$(".js-flickity").on("cellSelect",function(){var b=$(".gallery").data("flickity");if(b){var d=b.selectedElement,b=!0;a.flktySelected||(b=!1);a.flktySelected==d&&(b=!1);a.flktySelected=d;b&&(b=$("img",d),$(b).data("lazy")&&($(b).attr("src",$(b).data("lazy")),$(b).data("lazy",null)),a.flktyTimeout&&clearTimeout(a.flktyTimeout),a.flktyTimeout=setTimeout(function(){var a=$(d).data("itemid");History.pushState({action:"item-show",eid:a,i:a},"Loading ...","?i="+a)},1E3))}})};a.force=function(){a.cw=
a.ch=0;a.on()};a.on=function(){var b=$(window),c=b.width(),d=b.height();if(c!=a.cw||d!=a.ch)a.cw=c,a.ch=d,ImgNext.hud();$(".gallery img").each(function(a){imgResizeToFit($(this),Fullscreen.isFullscreen?c:$("#fullscreenBox").width(),d-0,Fullscreen.isFullscreen,Fullscreen.isFullscreen)})}},ImgNext=new function(){var a=this;a.r=!1;a.i=null;a.il=[];a.p=null;a.next=[];a.nav=[];a.top=0;a.xhr=null;a.thumbsInit=function(){$(".thumbnail-xs a").each(function(){$(this).on("click",function(a){var c=gup("i",a.currentTarget.href);
History.pushState({action:"item-show",eid:$(a.target).attr("id"),i:c},"Loading ...","?i="+c);c=$("#fullscreenBox");$("html, body").animate({scrollTop:c.offset().top-($(window).height()-c.height())/2},600);return!1})})};a.init=function(){a.r||(a.r=!0,a.i=$("#detailFoto"),a.i.bind("load",a.loaded),a.p=$(".showProgress"))};a.start=function(b){a.init();a.i.show();var c=a.p.height();a.p.css("height",(0<c?c:$(window).height())+"px");a.i.removeAttr("src");a.next[b]?(History.log("Galery showing:",b),a.i.attr("src",
a.next[b])):a.i.css("height","0px");if(a.nav[b]){var c=$("#nextButt"),d=$("#prevButt"),f=c.attr("href"),e=d.attr("href"),f=f.substr(0,f.indexOf("i=")+2)+a.nav[b][0],e=e.substr(0,e.indexOf("i=")+2)+a.nav[b][1];c.attr("href",f);d.attr("href",e)}return!1};a.loaded=function(){};a.hud=function(){var a=$("#fullscreenBox");a.css("height","").css("width","");var c=a.width(),a=a.height(),a=$(window).height(),d=0;$(".gallery-cell img").each(function(){var a=$(this).height();a>d&&(d=a)});$(".gallery").width(c).height(d);
History.log("ImgNext.hud",c+"x"+a)};a.xhrHand=function(b,c,d,f,e){a.init();a.nav[b]=[c,d];f&&f!=a.i.attr("src")&&a.i.attr("src",f).data("i",b);e&&($("body").append('<img id="imgNextLoader'+c+'" class="noscreen" />'),a.il[c]=$("#imgNextLoader"+c).load(a.preloaded),a.il[c].attr("src",e).data("i",c))};a.preloaded=function(b){b=$(b.target);a.next[b.data("i")]=b.attr("src")}},Slideshow=new function(){var a=this;a.on=!1;a.t=0;a.s=5;a.f=function(){a.on&&($(".gallery").flickity("next"),a.next())};a.toggle=
function(){a.on=!a.on;a.next()};a.next=function(){clearTimeout(a.t);a.on&&(a.t=setTimeout(a.f,1E3*a.s))}},Fullscreen=new function(){var a=this;a.el=null;a.tool=null;a.state=null;a.isFullscreen=!1;a.d=$(document.documentElement);a.w=$(window);a.key=function(b){27==b.keyCode&&a.toggle();32==b.keyCode&&$("#nextButt").click()};a.init=function(){a.el=$("#fullscreenBox");if(0!==a.el.length){listen("aFullscreen","click",a.toggle);$("#fullscreenLeave").click(a.toggle);$("#prevButt").click(function(){return!1});
$("#nextButt").click(function(){return!1});a.tool=$("#photoToolbar");var b=$("#aSlideshow img");b.click(function(){b.attr("src",b.attr("src").replace(Slideshow.on?"stop":"play",Slideshow.on?"play":"stop"));Slideshow.toggle();return!1});Resize.init()}};a.toggle=function(){if(a.isFullscreen)a.onExit();else a.onEnter();return!1};a.onEnter=function(){a.isFullscreen=!0;a.state={y:a.w.scrollTop()};a.d.bind("keyup",a.key);a.el.addClass("fullscreen");a.w.scrollTop(0).scrollLeft(0);$("body").css("overflow",
"hidden");Resize.force()};a.onExit=function(){a.isFullscreen=!1;a.d.unbind("keyup",a.key);a.el.removeClass("fullscreen");$("body").css("overflow","auto");0<a.state.y&&a.w.scrollLeft(a.state.y);a.state=null;Resize.force()}};
function imgResizeToFit(a,b,c,d,f){a.removeAttr("height").removeAttr("width").css("width","auto").css("height","auto").css("top","").css("left","").css("position","").css("margin-top","");var e=a.width(),g=a.height(),h=Math.min(b/e,c/g);b=Math.round(h*e);h=Math.round(h*g);!f&&(b>e||h>g)&&(b=e,h=g);!f&&d&&c>g&&a.css("margin-top",(c-g)/2);a.css("height",Math.round(h)).css("width",Math.round(b))}
var GaleryEdit=new function(){var a=this;a.uploadStatus="";a.numToUpload=0;a.cfg={};a.lng={};a.init=function(b,c){a.cfg=b;a.lng=c;$("#uploadButt").off("click").click(function(){$("#fuga")[0].fuupGateIn("upload")});$("#cancelButt").off("click").click(function(){$("#fuga")[0].fuupGateIn("cancel")});$("#removeAllButt").off("click").click(function(){$("#fuga")[0].fuupGateIn("removeAll")});listen("delete-galery","click",GaleryEdit.del)};a.updateControls=function(){"statusBusy"==a.uploadStatus?($("#uploadButt").attr("disabled",
"disabled"),$("#cancelButt").removeAttr("disabled"),$("#removeAllButt").attr("disabled","disabled")):($("#cancelButt").attr("disabled","disabled"),0<a.numToUpload?($("#uploadButt").removeAttr("disabled"),$("#removeAllButt").removeAttr("disabled")):($("#uploadButt").attr("disabled","disabled"),$("#removeAllButt").attr("disabled","disabled")))};a.check=function(b,c){console.log("FUUP::"+b+" '"+c+"'");switch(b){case "imageUploaded":Fajax.send("page-fuup",a.cfg.page);break;case "imageNum":a.numToUpload=
parseInt(c);a.updateControls();break;case "status":a.uploadStatus=c;a.updateControls();"statusReady"==c&&0==$("#uploadControlsHeading").length&&$('<h2 id="uploadControlsHeading">'+a.lng.selectFiles+"</h2>").hide().appendTo("#uploadControls").slideDown("slow");break;case "error":alert(a.lng[c])}};a.del=function(a){a=Fajax;var c=gup("d",$(this).attr("href")).split("=").pop();confirm($(this).attr("title"))&&(a.add("item",c),a.send("item-delete"),a.formStop=!0,$("#i"+c).hide("slow",function(){$("#i"+
c).remove()}));return!1}};
(function(a){a.PeriodicalUpdater=function(b,c,d){function f(b){var d=jQuery.extend(!0,{},p);"function"==typeof c.data&&(d.data=c.data());d.data&&"number"==typeof d.data&&(d.data=d.data.toString());d.type=d.data?e.methodLoaded:e.methodLight;b||0===n?(g("Sending data"),a(function(){a.ajax(d)})):0<n&&t<n?(g("Sending data because we are at "+t+" of "+n+" calls"),a(function(){a.ajax(d)}),t++):-1==n?g("NOT sending data: stop has been called",1):g("NOT sending data: maximum number of calls reached - "+n,
1)}c||(c={});var e=jQuery.extend(!0,{url:b,cache:!1,methodLight:"GET",methodLoaded:"POST",data:"",minTimeout:1E3,maxTimeout:64E3,multiplier:2,maxCalls:0,autoStop:0,autoStopCallback:null,cookie:!1,runatonce:!1,verbose:0},c),g=function(a,b){if(e.verbose>=(b||1))try{console.log(a)}catch(c){}},h=null,k=null,q=null,l=e.minTimeout,n=e.maxCalls,v=e.autoStop,t=0,r=0,w=n,m=function(b){a(function(){null!==h&&clearTimeout(h);l=b;g("resetting timer to "+l+".",2);e.cookie&&a.cookie&&a.cookie(e.cookie.name,l,e.cookie);
h=setTimeout(f,l)})};e.cookie&&("boolean"==typeof e.cookie?e.cookie={name:b}:"object"!=typeof e.cookie&&(e.cookie={name:e.cookie.toString()}),e.cookie.name||(e.cookie.name=b),a.cookie?a.cookie(e.cookie.name)&&m(a.cookie(e.cookie.name)):a.getScript("https://raw.github.com/carhartl/jquery-cookie/master/jquery.cookie.js",function(){g("Loaded the cookies handler script",2);a.cookie(e.cookie.name)?(g("Not runatonce and have cookie value",2),m(a.cookie(e.cookie.name))):(g("Not runatonce, but no cookie value",
2),m(l))}).fail(function(){g("Could not load the cookies handler script",1);m(l)}));var p=jQuery.extend(!0,{},e);e.type&&!p.dataType&&(p.dataType=e.type);e.sendData&&(p.data=e.sendData);p.ifModified=!0;var u={boostTimer:function(a){0<a&&1!=a?(g("Boosting timer by a factor of "+a),l*=a):g("Cannot boost timer by a factor of "+a);m(l)},restart:function(a){g("Calling restart");n=w;r=t=0;m(a||l)},send:function(){g("Explicit call to send");f(!0)},stop:function(){g("Calling stop");n=-1;e.cookie&&a.cookie&&
a.cookie(e.cookie.name,null,e.cookie)}};p.success=function(a){g("Successful run! (In 'success')",2);k=a};p.complete=function(b,c){g("Status of call: "+c+" (In 'complete')",2);if("success"==c||"notmodified"==c){var f=a.trim(b.responseText);if(q==f){if(0<v&&(r++,r==v)){u.stop();e.autoStopCallback&&e.autoStopCallback(r);return}1<e.multiplier&&(f=l,l*=e.multiplier,l>e.maxTimeout&&(l=e.maxTimeout),g("adjusting timer from "+f+" to "+l+".",2));m(l)}else r=0,m(e.minTimeout),q=f,e.cookie&&a.cookie(e.cookie.name,
q,e.cookie),null===k&&(k=f),"json"===p.dataType&&"string"===typeof k&&"success"==c&&(k=JSON.parse(k)),e.success&&e.success(k,c,b,u),d&&d(k,c,b,u)}e.complete&&e.complete(b,c);k=null};p.error=function(b,c){g("Error message: "+c+" (In 'error')",2);"notmodified"!=c&&(q=null,e.cookie&&a.cookie(e.cookie.name,null,e.cookie),m(e.minTimeout));e.error&&e.error(b,c)};e.runatonce?(g("Executing a call immediately",1),f(!0)):a.cookie&&a.cookie(e.cookie.name)||(g("Enqueing a the call for after "+l,1),m(l));return u};
a.fn.PeriodicalUpdater=function(b,c,d){var f=this;return a.PeriodicalUpdater(b,c,function(){return d.apply(f,arguments)})}})(jQuery);
(function(a){a.fn.unveil=function(b,c){function d(){k=h.filter(function(){var b=a(this),c=f.scrollTop(),d=c+f.height(),g=b.offset().top;return g+b.height()>=c-e&&g<=d+e}).trigger("unveil");h=h.not(k)}var f=a(window),e=b||0,g=1<window.devicePixelRatio?"data-src-retina":"data-src",h=this,k;this.one("unveil",function(){var a=this.getAttribute(g);if(a=a||this.getAttribute("data-src"))this.setAttribute("src",a),"function"===typeof c&&c.call(this)});f.scroll(d);f.resize(d);d();return this}})(window.jQuery||
window.Zepto);
var Lazy=new function(){var a=this;a.r={};a.f=null;a.q=[];a.loading=!1;a.load=function(b,c){for(var d=!0,f=0;f<b.length;f++)if(!a.r[b[f]]){d=!1;break}if(d)return d;a.q.push({l:b.concat(),f:c});if(!a.loading)return a.p()};a.p=function(){for(;0<a.q[0].l.length;){var b=a.q[0].l.shift();if(!a.r[b]){a.loading=!0;a.f=b;-1<b.indexOf(".css")?LazyLoad.css(b,function(){Lazy.c()}):LazyLoad.js(b,function(){Lazy.c()});return}}a.qc();return!0};a.c=function(){a.r[a.f]=!0;0<a.q[0].l.length?a.p():a.qc()};a.qc=function(){a.q[0].f&&
a.q[0].f();a.q.shift();0<a.q.length?a.p():a.loading=!1}};_fdk.fuup={fuga:{settings:{autoUpload:"0",showControls:"0",timeout:"60",showImages:"1",multi:"1",chunkSize:"131072",chunkLimit:"6",fileLimit:"80",image:{width:"2048",height:"2048",quality:"90",type:"jpg,jpeg,gif,png"},appSize:{width:"-1",height:"200"},callback:"GaleryEdit.check"},service:{url:"files.php",vars:{k:_fdk.cfg.page,f:"fuga",auth:_fdk.cfg.auth}}}};var tmp=jQuery.extend(!0,{},_fdk.fuup.fuga);tmp.settings.autoUpload="1";
tmp.settings.showImages="0";tmp.settings.multi="0";tmp.settings.appSize.width="100";tmp.settings.appSize.height="26";tmp.settings.callback="fuupUploadComplete";tmp.service.vars.f="tempStore";_fdk.fuup.tempStore=tmp;_fdk.fuup.fuga.settings.browseImg="http://fundekave.net/assets/browse_big.png"; 
